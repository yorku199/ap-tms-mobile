# คู่มือการใช้งาน TMS Mobile Application

## สารบัญ
1. [หน้าหลัก (Home Screen)](#หน้าหลัก-home-screen)
2. [หน้าเช็คอิน (Check-in Screen)](#หน้าเช็คอิน-check-in-screen)
3. [หน้า Job Order](#หน้า-job-order)
4. [Flow การทำงาน](#flow-การทำงาน)

---

## หน้าหลัก (Home Screen)

### ภาพหน้าจอ
- `Screenshot 2025-12-25 134759.png`
- `Screenshot 2025-12-25 134826.png`

### ฟีเจอร์หลัก
- แสดงเมนูหลักของแอปพลิเคชัน
- การนำทางไปยังหน้าต่างๆ

---

## หน้าเช็คอิน (Check-in Screen)

### ภาพหน้าจอ
- `Screenshot 2025-12-25 140132.png`
- `Screenshot 2025-12-25 140147.png`
- `Screenshot 2025-12-25 140215.png`
- `Screenshot 2025-12-25 140241.png`
- `Screenshot 2025-12-25 140323.png`
- `Screenshot 2025-12-25 140413.png`

### ขั้นตอนการใช้งาน

#### 1. การเช็คอินเข้างาน
1. เปิดหน้าเช็คอิน
2. ระบบจะแสดงแผนที่พร้อมตำแหน่งบริษัท
3. ตรวจสอบว่าอยู่ในรัศมีที่กำหนด (แสดงระยะทาง)
4. กดปุ่ม "เช็คอิน"
5. ระบบจะบันทึกเวลาเช็คอินและแสดงผล

#### 2. การเช็คเอาท์
1. หลังจากเช็คอินแล้ว
2. กดปุ่ม "เช็คเอาท์"
3. ระบบจะบันทึกเวลาเช็คเอาท์

#### 3. การแสดงผลเวลาเช็คอิน/เช็คเอาท์
- แสดงเวลาเช็คอินและเวลาเช็คเอาท์ **เฉพาะวันที่ปัจจุบันเท่านั้น**
- ถ้าวันนั้นไม่มีข้อมูล จะไม่แสดงอะไร

---

## หน้า Job Order

### ภาพหน้าจอ
- `Screenshot 2025-12-25 142211.png`
- `Screenshot 2025-12-25 142239.png`
- `Screenshot 2025-12-25 142300.png`
- `Screenshot 2025-12-25 142317.png`

### ขั้นตอนการใช้งาน

#### 1. การดู Job Orders
1. เปิดหน้า Job Order
2. ระบบจะแสดง Job Orders ของวันที่ปัจจุบัน
3. สามารถเลือกวันที่อื่นได้จากปฏิทิน
4. เมื่อเลือกวันที่ ระบบจะโหลดข้อมูลใหม่ตามวันที่ที่เลือก

#### 2. Timeline View
- แสดง Timeline แบบ 24 ชั่วโมง (00:00 - 23:00)
- แต่ละชั่วโมงมีวงกลมเป็น marker
- Job routes จะแสดงเป็นการ์ดบน timeline
- เส้นสีแดงแสดงเวลาปัจจุบัน

#### 3. การแสดงสถานะ
- **สถานะเข้างาน:**
  - เข้าก่อนเวลา (สีส้ม) - ถ้า `actual_in` ก่อน `plan_in` มากกว่า 10 นาที
  - เข้าตามเวลา (สีเขียว) - ถ้า `actual_in` = `plan_in` ± 10 นาที
  - เข้าสาย (สีแดง) - ถ้า `actual_in` หลัง `plan_in` มากกว่า 10 นาที

- **สถานะออกงาน:**
  - ออกก่อนเวลา (สีส้ม) - ถ้า `actual_out` ก่อน `plan_out` มากกว่า 10 นาที
  - ออกตามเวลา (สีเขียว) - ถ้า `actual_out` = `plan_out` ± 10 นาที
  - ออกก่อนเวลา (สีส้ม) - ถ้า `actual_out` หลัง `plan_out` มากกว่า 10 นาที

#### 4. การแสดง Check-in Times
- แสดงเวลาเช็คอินจาก `tb_check_in_job` บน timeline
- แสดงเป็น badge สีแดงพร้อมข้อความ "เช็คอิน" และเวลา
- อยู่ใกล้เส้น timeline แนวตั้งทางซ้าย

#### 5. การแสดง Actual Times
- แสดง `actual_in`, `actual_out`, `actual_in2`, `actual_out2` (ถ้ามี)
- แสดงเป็นข้อความสีเขียวพร้อมไอคอน check circle

---

## Flow การทำงาน

### Flow การเช็คอินเข้างาน

```mermaid
flowchart TD
    A[เปิดหน้าเช็คอิน] --> B{ตรวจสอบตำแหน่ง GPS}
    B -->|ได้ตำแหน่ง| C[คำนวณระยะทางจากบริษัท]
    B -->|ไม่ได้ตำแหน่ง| D[แสดงข้อความ error]
    C --> E{อยู่ในรัศมี?}
    E -->|ใช่| F[แสดงปุ่มเช็คอิน]
    E -->|ไม่ใช่| G[แสดงระยะทางและปิดการใช้งานปุ่ม]
    F --> H[กดปุ่มเช็คอิน]
    H --> I[บันทึกข้อมูลเช็คอิน]
    I --> J[อัพเดท actual_in/actual_out]
    J --> K[แสดงผลสำเร็จ]
    K --> L[แสดงเวลาเช็คอิน]
```

### Flow การดู Job Orders

```mermaid
flowchart TD
    A[เปิดหน้า Job Order] --> B[โหลดข้อมูลวันที่ปัจจุบัน]
    B --> C[ดึงข้อมูล Job Orders]
    C --> D[ดึงข้อมูล Check-in Times]
    D --> E[แสดง Timeline]
    E --> F[แสดง Job Routes]
    F --> G[แสดง Check-in Badges]
    G --> H[คำนวณและแสดงสถานะ]
    H --> I{ผู้ใช้เลือกวันที่?}
    I -->|ใช่| B
    I -->|ไม่ใช่| J[แสดงข้อมูลปัจจุบัน]
```

### Flow การคำนวณสถานะ

```mermaid
flowchart TD
    A[มี actual_in และ plan_in?] -->|ใช่| B[คำนวณ diffMinutes]
    A -->|ไม่ใช่| Z[ไม่แสดงสถานะ]
    B --> C{diffMinutes < -10?}
    C -->|ใช่| D[แสดง 'เข้าก่อนเวลา']
    C -->|ไม่ใช่| E{diffMinutes <= 10?}
    E -->|ใช่| F[แสดง 'เข้าตามเวลา']
    E -->|ไม่ใช่| G{diffMinutes > 10?}
    G -->|ใช่| H[แสดง 'เข้าสาย']
    G -->|ไม่ใช่| Z
```

---

## หมายเหตุ

- เวลาทั้งหมดแสดงในรูปแบบ UTC+7 (Thailand time)
- การคำนวณสถานะทำที่ Backend API
- Timeline จะเลื่อนอัตโนมัติไปที่เส้นเวลาปัจจุบัน
- ข้อมูลจะ refresh อัตโนมัติหลังจากเช็คอิน

---

## การแก้ไขปัญหา

### ปัญหา: ไม่แสดงข้อมูลเช็คอิน
- ตรวจสอบว่าเช็คอินในวันที่ปัจจุบันหรือไม่
- ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต

### ปัญหา: สถานะไม่แสดง
- ตรวจสอบว่ามี `actual_in`/`actual_out` และ `plan_in`/`plan_out` หรือไม่
- ตรวจสอบว่าเวลาต่างกันเกิน ±10 นาทีหรือไม่

---

*เอกสารนี้สร้างจาก Screenshot วันที่ 25 ธันวาคม 2025*

